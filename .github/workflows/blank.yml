name: Build and Deploy

on:
  push:
    branches:
      - alpha.lambdax.san

    paths-ignore:
      - '**.md'
      - 'docs/**'

env:
  BRANCH_NAME: ${{ github.head_ref || github.ref_name }}
  EC2_USER: ${{ secrets.EC2_USER }}
  DOCKER_IMAGE_TAG: ${{ github.head_ref || github.ref_name }}


jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Set variables
        run: |
          if [[ "$BRANCH_NAME" == 'alpha.lambdax.san' ]]; then
            echo "EC2_HOSTNAME=ec2-18-204-213-193.compute-1.amazonaws.com" >> "$GITHUB_ENV"          
          fi
      
      - name: Deploy to specified server alpha.lambdax.san
        if: startsWith(env.BRANCH_NAME, 'alpha.lambdax.san')
        run: |
          mkdir -p /tmp/santhosh
